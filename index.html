<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RomanCraft - Assistant d'√©criture complet</title>
    <meta name="description" content="Application d'aide √† l'√©criture pour auteurs de romans">
    <meta name="theme-color" content="#4a306d">
    <link rel="manifest" href="data:application/manifest+json,{}">
    <style>
        :root {
            --primary: #4a306d;
            --secondary: #7b52ab;
            --light: #f5f0ff;
            --dark: #2d1b4e;
            --accent: #e6b0ff;
            --text: #333333;
            --shadow: rgba(74, 48, 109, 0.2);
            --success: #4CAF50;
            --warning: #FF9800;
            --danger: #F44336;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--text);
            line-height: 1.6;
        }
        
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px var(--shadow);
            text-align: center;
            position: relative;
        }
        
        .header-actions {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .tab-button {
            padding: 12px 20px;
            background-color: white;
            border: 2px solid var(--primary);
            border-radius: 30px;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab-button:hover {
            background-color: var(--accent);
        }
        
        .tab-button.active {
            background-color: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px var(--shadow);
            margin-bottom: 20px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 2px var(--accent);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-row > div {
            flex: 1;
        }
        
        .btn {
            padding: 12px 24px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px var(--shadow);
        }
        
        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background-color: var(--light);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-warning {
            background-color: var(--warning);
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
        }
        
        .card h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .card p {
            margin-bottom: 10px;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .inspiration-section {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .inspiration-item {
            background-color: white;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .inspiration-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px var(--shadow);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--primary);
            margin-right: 15px;
            float: left;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .role-tag {
            display: inline-block;
            padding: 4px 8px;
            background-color: var(--accent);
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .location-category {
            margin-bottom: 30px;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .location-category h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .custom-location-form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border: 2px dashed var(--primary);
        }
        
        .plot-category {
            margin-bottom: 30px;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .plot-category h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .custom-plot-form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border: 2px dashed var(--primary);
        }
        
        .plot-tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            border-bottom: 1px dotted var(--primary);
        }
        
        .plot-tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .plot-tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .header-actions {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }
            
            .plot-tooltip .tooltiptext {
                width: 250px;
                margin-left: -125px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <h1>RomanCraft Pro</h1>
            <p class="subtitle">Votre assistant personnel pour cr√©er des romans captivants</p>
            <div class="header-actions">
                <button class="btn btn-secondary" id="import-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                    </svg>
                    Importer
                </button>
                <button class="btn btn-success" id="export-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                    </svg>
                    Exporter
                </button>
            </div>
        </header>
        
        <div class="nav-tabs">
            <button class="tab-button active" data-tab="dashboard">Tableau de bord</button>
            <button class="tab-button" data-tab="characters">Personnages</button>
            <button class="tab-button" data-tab="locations">Lieux</button>
            <button class="tab-button" data-tab="plot">Intrigue</button>
            <button class="tab-button" data-tab="inspiration">Inspiration</button>
            <button class="tab-button" data-tab="story-roles">R√¥les narratifs</button>
        </div>
        
        <!-- Tableau de bord -->
        <div id="dashboard" class="tab-content active">
            <h2>Tableau de bord</h2>
            <p>Bienvenue dans votre espace d'√©criture. Utilisez les diff√©rentes sections pour d√©velopper votre univers litt√©raire.</p>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="character-count">0</div>
                    <div class="stat-label">Personnages</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="location-count">0</div>
                    <div class="stat-label">Lieux</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="plot-count">0</div>
                    <div class="stat-label">√âl√©ments d'intrigue</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="role-count">0</div>
                    <div class="stat-label">R√¥les narratifs</div>
                </div>
            </div>
            
            <div class="inspiration-section">
                <h3>Conseil du jour</h3>
                <div class="inspiration-item">
                    <p id="daily-tip">Pour donner vie √† vos personnages, imaginez comment ils r√©agiraient dans des situations quotidiennes banales, comme faire la queue ou perdre leurs cl√©s.</p>
                </div>
            </div>
        </div>
        
        <!-- Personnages -->
        <div id="characters" class="tab-content">
            <h2>Cr√©ation de personnages</h2>
            <p>D√©veloppez des personnages complexes et m√©morables avec cette fiche d√©taill√©e.</p>
            
            <form id="character-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="character-name">Nom du personnage</label>
                        <input type="text" id="character-name" required>
                    </div>
                    <div class="form-group">
                        <label for="character-role">R√¥le principal</label>
                        <select id="character-role">
                            <option value="protagonist">Protagoniste</option>
                            <option value="antagonist">Antagoniste</option>
                            <option value="deuteragonist">Deut√©ragoniste</option>
                            <option value="tritagonist">Tritagoniste</option>
                            <option value="confidant">Confident</option>
                            <option value="love-interest">Int√©r√™t amoureux</option>
                            <option value="foil">Contrepoint</option>
                            <option value="mentor">Mentor</option>
                            <option value="supporting">Secondaire</option>
                            <option value="minor">Figurant</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="character-story-roles">R√¥les narratifs (optionnel)</label>
                    <div id="story-roles-checkboxes">
                        <!-- Les cases √† cocher seront g√©n√©r√©es dynamiquement -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="character-appearance">Apparence physique</label>
                    <textarea id="character-appearance" placeholder="D√©crivez l'apparence de votre personnage..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="character-personality">Personnalit√© et traits de caract√®re</label>
                    <textarea id="character-personality" placeholder="D√©crivez la personnalit√© de votre personnage..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="character-backstory">Histoire personnelle</label>
                    <textarea id="character-backstory" placeholder="Racontez le pass√© de votre personnage..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="character-motivations">Motivations et objectifs</label>
                    <textarea id="character-motivations" placeholder="Qu'est-ce qui motive votre personnage?"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="character-flaws">Faiblesses et d√©fauts</label>
                    <textarea id="character-flaws" placeholder="Quels sont les d√©fauts de votre personnage?"></textarea>
                </div>
                
                <button type="submit" class="btn">Enregistrer le personnage</button>
            </form>
            
            <div id="characters-list" class="grid" style="margin-top: 30px;">
                <!-- Les personnages cr√©√©s appara√Ætront ici -->
            </div>
        </div>
        
        <!-- Lieux -->
        <div id="locations" class="tab-content">
            <h2>Cr√©ation de lieux</h2>
            <p>D√©finissez l'atmosph√®re et les d√©tails de vos diff√©rents lieux pour immerger vos lecteurs.</p>
            
            <form id="location-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="location-name">Nom du lieu</label>
                        <input type="text" id="location-name" required>
                    </div>
                    <div class="form-group">
                        <label for="location-type">Type de lieu</label>
                        <select id="location-type">
                            <!-- Les options seront g√©n√©r√©es dynamiquement -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="location-description">Description</label>
                    <textarea id="location-description" placeholder="D√©crivez ce lieu en d√©tail..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location-atmosphere">Atmosph√®re et ambiance</label>
                    <textarea id="location-atmosphere" placeholder="Quelle ambiance se d√©gage de ce lieu?"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location-history">Histoire du lieu</label>
                    <textarea id="location-history" placeholder="Quelle est l'histoire de ce lieu?"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location-importance">Importance dans l'histoire</label>
                    <textarea id="location-importance" placeholder="Quel r√¥le joue ce lieu dans votre r√©cit?"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="location-characters">Personnages associ√©s</label>
                    <input type="text" id="location-characters" placeholder="Quels personnages sont li√©s √† ce lieu?">
                </div>
                
                <button type="submit" class="btn">Enregistrer le lieu</button>
            </form>
            
            <!-- Formulaire pour ajouter un nouveau type de lieu -->
            <div class="custom-location-form">
                <h3>Ajouter un nouveau type de lieu</h3>
                <form id="custom-location-type-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="new-location-type">Nom du nouveau type</label>
                            <input type="text" id="new-location-type" required>
                        </div>
                        <div class="form-group">
                            <label for="new-location-category">Cat√©gorie</label>
                            <select id="new-location-category">
                                <option value="urban">üèôÔ∏è Lieux urbains modernes</option>
                                <option value="nature">üå≤ Lieux naturels ou isol√©s</option>
                                <option value="historical">üï∞Ô∏è Lieux charg√©s d'histoire</option>
                                <option value="futuristic">üß¨ Lieux futuristes ou technologiques</option>
                                <option value="mysterious">üåô Lieux myst√©rieux ou symboliques</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-secondary">Ajouter ce type</button>
                </form>
            </div>
            
            <div id="locations-list" class="grid" style="margin-top: 30px;">
                <!-- Les lieux cr√©√©s appara√Ætront ici -->
            </div>
        </div>
        
        <!-- Intrigue -->
        <div id="plot" class="tab-content">
            <h2>D√©veloppement de l'intrigue</h2>
            <p>Structurez votre histoire avec des √©l√©ments narratifs cl√©s. <span class="plot-tooltip">Passez votre souris sur les √©l√©ments pour voir leur explication
                <span class="tooltiptext">Chaque √©l√©ment narratif a une fonction sp√©cifique dans la construction de votre histoire. Ces explications vous aideront √† choisir les bons √©l√©ments pour chaque moment de votre r√©cit.</span>
            </span></p>
            
            <form id="plot-form">
                <div class="form-group">
                    <label for="plot-element-type">Type d'√©l√©ment narratif</label>
                    <select id="plot-element-type">
                        <!-- Les options seront g√©n√©r√©es dynamiquement -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="plot-title">Titre de l'√©l√©ment</label>
                    <input type="text" id="plot-title" required>
                </div>
                
                <div class="form-group">
                    <label for="plot-description">Description</label>
                    <textarea id="plot-description" placeholder="D√©crivez cet √©l√©ment narratif..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="plot-characters">Personnages impliqu√©s</label>
                    <input type="text" id="plot-characters" placeholder="Listez les personnages concern√©s...">
                </div>
                
                <div class="form-group">
                    <label for="plot-locations">Lieux concern√©s</label>
                    <input type="text" id="plot-locations" placeholder="O√π se d√©roule cet √©l√©ment?">
                </div>
                
                <div class="form-group">
                    <label for="plot-importance">Importance narrative</label>
                    <select id="plot-importance">
                        <option value="low">Faible</option>
                        <option value="medium">Moyenne</option>
                        <option value="high">√âlev√©e</option>
                        <option value="critical">Critique</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Enregistrer l'√©l√©ment</button>
            </form>
            
            <!-- Formulaire pour ajouter un nouveau type d'√©l√©ment narratif -->
            <div class="custom-plot-form">
                <h3>Ajouter un nouveau type d'√©l√©ment narratif</h3>
                <form id="custom-plot-type-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="new-plot-type">Nom du nouveau type</label>
                            <input type="text" id="new-plot-type" required>
                        </div>
                        <div class="form-group">
                            <label for="new-plot-category">Cat√©gorie</label>
                            <select id="new-plot-category">
                                <option value="structure">üß© Structure et dynamique de l'histoire</option>
                                <option value="emotions">üíî √âmotions et relations</option>
                                <option value="dramatic">‚öôÔ∏è Fonctions dramatiques secondaires</option>
                                <option value="symbolic">üåô Symboliques et th√©matiques</option>
                                <option value="classic">üé≠ √âl√©ments narratifs classiques</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-secondary">Ajouter ce type</button>
                </form>
            </div>
            
            <div id="plot-list" class="grid" style="margin-top: 30px;">
                <!-- Les √©l√©ments d'intrigue cr√©√©s appara√Ætront ici -->
            </div>
        </div>
        
        <!-- Inspiration -->
        <div id="inspiration" class="tab-content">
            <h2>Bo√Æte √† id√©es</h2>
            <p>Des g√©n√©rateurs al√©atoires pour stimuler votre cr√©ativit√©.</p>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de conflits</h3>
                <div class="inspiration-item" id="conflict-generator">
                    <p>Cliquez pour g√©n√©rer un conflit narratif</p>
                </div>
                <button class="btn" id="generate-conflict">Nouveau conflit</button>
            </div>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de relations entre personnages</h3>
                <div class="inspiration-item" id="relationship-generator">
                    <p>Cliquez pour g√©n√©rer une relation entre personnages</p>
                </div>
                <button class="btn" id="generate-relationship">Nouvelle relation</button>
            </div>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de sc√©narios</h3>
                <div class="inspiration-item" id="scenario-generator">
                    <p>Cliquez pour g√©n√©rer un sc√©nario de d√©part</p>
                </div>
                <button class="btn" id="generate-scenario">Nouveau sc√©nario</button>
            </div>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de concepts de mondes</h3>
                <div class="inspiration-item" id="world-generator">
                    <p>Cliquez pour g√©n√©rer un concept de monde</p>
                </div>
                <button class="btn" id="generate-world">Nouveau concept</button>
            </div>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de dilemmes moraux</h3>
                <div class="inspiration-item" id="dilemma-generator">
                    <p>Cliquez pour g√©n√©rer un dilemme moral</p>
                </div>
                <button class="btn" id="generate-dilemma">Nouveau dilemme</button>
            </div>
            
            <div class="inspiration-section">
                <h3>G√©n√©rateur de fins alternatives</h3>
                <div class="inspiration-item" id="ending-generator">
                    <p>Cliquez pour g√©n√©rer une fin alternative</p>
                </div>
                <button class="btn" id="generate-ending">Nouvelle fin</button>
            </div>
        </div>
        
        <!-- R√¥les narratifs -->
        <div id="story-roles" class="tab-content">
            <h2>R√¥les narratifs</h2>
            <p>D√©finissez des r√¥les narratifs que vous pouvez attribuer √† vos personnages pour enrichir votre histoire.</p>
            
            <form id="story-role-form">
                <div class="form-group">
                    <label for="role-name">Nom du r√¥le</label>
                    <input type="text" id="role-name" required>
                </div>
                
                <div class="form-group">
                    <label for="role-description">Description du r√¥le</label>
                    <textarea id="role-description" placeholder="D√©crivez ce r√¥le narratif..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="role-examples">Exemples de personnages</label>
                    <textarea id="role-examples" placeholder="Donnez des exemples de personnages c√©l√®bres qui remplissent ce r√¥le..."></textarea>
                </div>
                
                <button type="submit" class="btn">Ajouter le r√¥le</button>
            </form>
            
            <div id="story-roles-list" class="grid" style="margin-top: 30px;">
                <!-- Les r√¥les narratifs cr√©√©s appara√Ætront ici -->
            </div>
        </div>
        
        <footer>
            <p>RomanCraft Pro - Votre compagnon d'√©criture ‚Ä¢ Toutes vos donn√©es sont stock√©es localement sur votre appareil</p>
        </footer>
    </div>

    <!-- Modal d'exportation -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Exporter vos donn√©es</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>Choisissez le format d'exportation :</p>
            <div class="export-options">
                <button class="btn" id="export-json">JSON</button>
                <button class="btn btn-success" id="export-word">Word (.docx)</button>
                <button class="btn" id="export-text">Texte brut</button>
            </div>
        </div>
    </div>

    <!-- Modal d'importation -->
    <div class="modal" id="import-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Importer des donn√©es</h3>
                <button class="close-modal">&times;</button>
            </div>
            <p>S√©lectionnez un fichier √† importer :</p>
            <div class="form-group">
                <input type="file" id="import-file" accept=".json,.txt,.docx">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="import-merge">
                    Fusionner avec les donn√©es existantes
                </label>
            </div>
            <button class="btn" id="confirm-import">Importer</button>
        </div>
    </div>

    <script>
        // Donn√©es de l'application
        let appData = {
            characters: [],
            locations: [],
            plotElements: [],
            storyRoles: [
                {
                    id: 1,
                    name: "Le H√©ros",
                    description: "Le personnage principal qui m√®ne l'histoire et subit une transformation.",
                    examples: "Luke Skywalker (Star Wars), Harry Potter"
                },
                {
                    id: 2,
                    name: "Le Mentor",
                    description: "Guide le h√©ros en partageant sagesse et exp√©rience.",
                    examples: "Obi-Wan Kenobi (Star Wars), Dumbledore (Harry Potter)"
                },
                {
                    id: 3,
                    name: "Le Gardien du Seuil",
                    description: "Teste le h√©ros avant qu'il ne puisse progresser dans son voyage.",
                    examples: "Cerb√®re (mythologie grecque), le Sphinx (≈ídipe)"
                },
                {
                    id: 4,
                    name: "Le H√©raut",
                    description: "Annonce l'arriv√©e d'un changement important dans l'histoire.",
                    examples: "R2-D2 (Star Wars), Hedwige (Harry Potter)"
                },
                {
                    id: 5,
                    name: "Le Change-forme",
                    description: "Personnage dont la loyaut√© ou la nature est ambigu√´.",
                    examples: "Han Solo (Star Wars), Severus Rogue (Harry Potter)"
                },
                {
                    id: 6,
                    name: "L'Ombre",
                    description: "Repr√©sente les c√¥t√©s sombres ou refoul√©s du h√©ros.",
                    examples: "Voldemort (Harry Potter), Dark Vador (Star Wars)"
                },
                {
                    id: 7,
                    name: "Le Trickster",
                    description: "Apporte l'humour et d√©fie les conventions √©tablies.",
                    examples: "Merlin (Arthur), Loki (mythologie nordique)"
                }
            ],
            locationTypes: {
                "urban": [
                    "Station de m√©tro", "Gratte-ciel", "Immeuble", "Mus√©e", "H√¥tel de luxe",
                    "Biblioth√®que", "Toit d'immeuble", "Parking souterrain", "Pont suspendu",
                    "Rue pi√©tonne", "Appartement", "Centre commercial", "Quai de gare",
                    "Gare", "H√¥pital", "Couloir de maintenance", "Jardin", "Tunnel"
                ],
                "nature": [
                    "Cabane", "Phare", "Plage", "Grotte", "Rivage", "Jardin d'hiver",
                    "Ferme", "Lac", "Sentier", "For√™t", "Montagne", "D√©sert", "Oc√©an", "√éle"
                ],
                "historical": [
                    "Abbaye", "Asile", "Monast√®re", "Maison bourgeoise", "H√¥tel particulier",
                    "Bunker", "Ch√¢teau", "Ruines", "Temple"
                ],
                "futuristic": [
                    "Cit√© flottante", "Laboratoire", "Station orbitale", "Parc d'attractions",
                    "Donjon", "Labyrinthe", "March√©", "Palais"
                ],
                "mysterious": [
                    "Un th√©√¢tre o√π les acteurs jouent sans spectateurs",
                    "Un ascenseur qui s'arr√™te parfois √† un √©tage inexistant",
                    "Cimeti√®re", "Eglise", "Cath√©drale", "Chapelle", "Crypte"
                ],
                "other": [
                    "Ville", "Village", "Maison", "Taverne", "Autre"
                ]
            },
            plotTypes: {
                "structure": [
                    {name: "Prologue", description: "Introduction qui met en place le ton g√©n√©ral ou un √©v√©nement pass√© d√©terminant pour l'histoire"},
                    {name: "√âl√©ment perturbateur", description: "L'√©v√©nement initial qui bouleverse l'√©quilibre de la situation et lance l'action principale"},
                    {name: "Mont√©e de la tension", description: "S√©rie d'√©v√©nements qui amplifient progressivement les enjeux et la pression sur les personnages"},
                    {name: "Retournement de situation (twist)", description: "Changement inattendu de direction narrative qui modifie la perception de l'histoire"},
                    {name: "Fausse piste", description: "√âl√©ment trompeur qui oriente d√©lib√©r√©ment le lecteur vers une conclusion erron√©e"},
                    {name: "D√©nouement", description: "R√©solution finale qui apporte une fermeture logique ou √©motionnelle aux conflits principaux"},
                    {name: "√âpilogue", description: "Section finale qui offre un regard sur les cons√©quences de l'histoire, parfois dans un futur lointain"}
                ],
                "emotions": [
                    {name: "Moment de doute", description: "Point o√π le protagoniste remet en question ses convictions, ses capacit√©s ou sa mission"},
                    {name: "Confrontation", description: "Rencontre directe et souvent explosive entre le h√©ros et l'antagoniste principal"},
                    {name: "Perte", description: "√âv√©nement douloureux impliquant la mort, la s√©paration ou le renoncement √† quelque chose de pr√©cieux"},
                    {name: "R√©conciliation", description: "R√©tablissement d'un lien bris√© entre personnages, souvent apr√®s un conflit important"},
                    {name: "Confession", description: "R√©v√©lation intime d'un secret, d'un pass√© cach√© ou de sentiments refoul√©s"},
                    {name: "Tentations", description: "Situation pr√©sentant un choix moral difficile ou une attirance dangereuse pour le personnage"},
                    {name: "Illumination", description: "Prise de conscience soudaine qui apporte une compr√©hension profonde d'une v√©rit√© essentielle"}
                ],
                "dramatic": [
                    {name: "Catalyseur", description: "√âv√©nement ou personnage qui acc√©l√®re le changement et pousse l'action vers l'avant"},
                    {name: "Obstacle", description: "Barri√®re concr√®te ou psychologique qui bloque temporairement la progression du h√©ros"},
                    {name: "Alli√©", description: "Personnage secondaire qui apporte son aide et soutient le protagoniste dans son √©volution"},
                    {name: "Mentor", description: "Figure guide qui transmet sagesse, savoir ou pouvoir au personnage principal"},
                    {name: "Antagoniste int√©rieur", description: "Conflit interne repr√©sentant les peurs, culpabilit√©s ou traumas du h√©ros"},
                    {name: "MacGuffin", description: "Objet ou but qui motive l'action des personnages sans avoir d'importance r√©elle en soi"}
                ],
                "symbolic": [
                    {name: "Mirage / illusion", description: "Situation cr√©ant une confusion entre la r√©alit√© et les apparences trompeuses"},
                    {name: "Cycle", description: "R√©p√©tition d'un motif, d'un sch√©ma ou d'un destin √† travers l'histoire"},
                    {name: "√âpreuve initiatique", description: "√âtape cruciale qui marque la transformation et la maturation du h√©ros"},
                    {name: "Rupture du monde ordinaire", description: "Passage d√©cisif du h√©ros vers un univers diff√©rent ou extraordinaire"},
                    {name: "Retour au foyer", description: "Moment o√π le h√©ros revient chang√©, apportant avec lui les enseignements de son voyage"},
                    {name: "Message moral", description: "Le sens final et la le√ßon philosophique qui √©merge de l'exp√©rience v√©cue"}
                ],
                "classic": [
                    {name: "√âl√©ment d√©clencheur", description: "√âv√©nement initial qui perturbe l'√©quilibre et lance l'intrigue principale"},
                    {name: "Premier point de l'intrigue", description: "Moment charni√®re qui engage d√©finitivement le h√©ros dans l'aventure"},
                    {name: "Deuxi√®me point de l'intrigue", description: "√âv√©nement qui relance l'action avant le climax et augmente les enjeux"},
                    {name: "Point m√©dian", description: "Tournant au milieu de l'histoire qui change la donne et la perception des √©v√©nements"},
                    {name: "Climax", description: "Point culminant de l'intrigue o√π le conflit principal atteint son paroxysme"},
                    {name: "R√©solution", description: "D√©nouement qui apporte une conclusion aux diff√©rents fils narratifs"},
                    {name: "Rebondissement", description: "R√©v√©lation surprise qui modifie radicalement la compr√©hension de l'histoire"},
                    {name: "Conflit", description: "Opposition entre forces, personnages ou id√©es qui g√©n√®re la tension dramatique"},
                    {name: "Pr√©figuration", description: "Indice subtil qui annonce un √©v√©nement futur important"},
                    {name: "R√©v√©lation", description: "D√©voilement d'une information cach√©e qui √©claire l'intrigue sous un nouveau jour"},
                    {name: "Revers", description: "√âchec ou d√©faite temporaire qui teste la r√©silience du h√©ros"},
                    {name: "Victoire", description: "Succ√®s important qui marque une avanc√©e significative dans la qu√™te"},
                    {name: "Moment le plus sombre", description: "Point o√π tout semble perdu et le h√©ros touche le fond du d√©sespoir"},
                    {name: "R√©demption", description: "Processus par lequel un personnage se rach√®te de ses fautes pass√©es"},
                    {name: "Trahison", description: "Acte de d√©loyaut√© qui brise la confiance et modifie les alliances"},
                    {name: "Sacrifice", description: "Acte de renoncement d√©sint√©ress√© pour une cause ou une personne plus grande"}
                ],
                "other": [
                    {name: "Autre", description: "√âl√©ment narratif personnalis√© ne correspondant pas aux cat√©gories pr√©d√©finies"}
                ]
            }
        };
        
        // Charger les donn√©es depuis le localStorage
        function loadData() {
            const savedData = localStorage.getItem('romanCraftData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                appData.characters = parsedData.characters || [];
                appData.locations = parsedData.locations || [];
                appData.plotElements = parsedData.plotElements || [];
                appData.storyRoles = parsedData.storyRoles || appData.storyRoles;
                appData.locationTypes = parsedData.locationTypes || appData.locationTypes;
                appData.plotTypes = parsedData.plotTypes || appData.plotTypes;
                updateDashboard();
                renderCharacters();
                renderLocations();
                renderPlotElements();
                renderStoryRoles();
                updateStoryRolesCheckboxes();
                updateLocationTypesDropdown();
                updatePlotTypesDropdown();
            }
        }
        
        // Sauvegarder les donn√©es dans le localStorage
        function saveData() {
            localStorage.setItem('romanCraftData', JSON.stringify(appData));
            updateDashboard();
        }
        
        // Mettre √† jour le tableau de bord
        function updateDashboard() {
            document.getElementById('character-count').textContent = appData.characters.length;
            document.getElementById('location-count').textContent = appData.locations.length;
            document.getElementById('plot-count').textContent = appData.plotElements.length;
            document.getElementById('role-count').textContent = appData.storyRoles.length;
            
            // Mettre √† jour le conseil du jour
            const tips = [
                "Pour donner vie √† vos personnages, imaginez comment ils r√©agiraient dans des situations quotidiennes banales.",
                "Un bon antagoniste croit √™tre le h√©ros de sa propre histoire. Donnez-lui des motivations cr√©dibles.",
                "Les lieux peuvent √™tre des personnages √† part enti√®re. Pensez √† leur histoire et √† leur atmosph√®re.",
                "L'intrigue devrait avancer gr√¢ce aux d√©cisions des personnages, pas par co√Øncidence.",
                "Montrez, ne racontez pas. Au lieu de dire 'il avait peur', d√©crivez ses mains tremblantes.",
                "Cr√©ez des tensions en donnant √† vos personnages des objectifs contradictoires.",
                "Un bon dialogue r√©v√®le la personnalit√© des personnages et fait avancer l'intrigue.",
                "N'ayez pas peur de faire souffrir vos personnages. Les √©preuves les rendent plus int√©ressants.",
                "√âtablissez des r√®gles claires pour votre univers et respectez-les pour maintenir la cr√©dibilit√©.",
                "La fin devrait √™tre √† la fois surprenante et in√©vitable, d√©coulant naturellement de l'histoire."
            ];
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            document.getElementById('daily-tip').textContent = randomTip;
        }
        
        // Mettre √† jour la liste d√©roulante des types de lieux
        function updateLocationTypesDropdown() {
            const select = document.getElementById('location-type');
            select.innerHTML = '';
            
            // Ajouter les types de lieux par cat√©gorie
            Object.keys(appData.locationTypes).forEach(category => {
                const optgroup = document.createElement('optgroup');
                
                // D√©finir les labels des cat√©gories
                const categoryLabels = {
                    "urban": "üèôÔ∏è Lieux urbains modernes",
                    "nature": "üå≤ Lieux naturels ou isol√©s", 
                    "historical": "üï∞Ô∏è Lieux charg√©s d'histoire",
                    "futuristic": "üß¨ Lieux futuristes ou technologiques",
                    "mysterious": "üåô Lieux myst√©rieux ou symboliques",
                    "other": "Autres lieux"
                };
                
                optgroup.label = categoryLabels[category] || category;
                
                appData.locationTypes[category].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    optgroup.appendChild(option);
                });
                
                select.appendChild(optgroup);
            });
        }
        
        // Mettre √† jour la liste d√©roulante des types d'√©l√©ments narratifs
        function updatePlotTypesDropdown() {
            const select = document.getElementById('plot-element-type');
            select.innerHTML = '';
            
            // Ajouter les types d'√©l√©ments narratifs par cat√©gorie
            Object.keys(appData.plotTypes).forEach(category => {
                const optgroup = document.createElement('optgroup');
                
                // D√©finir les labels des cat√©gories
                const categoryLabels = {
                    "structure": "üß© Structure et dynamique de l'histoire",
                    "emotions": "üíî √âmotions et relations",
                    "dramatic": "‚öôÔ∏è Fonctions dramatiques secondaires",
                    "symbolic": "üåô Symboliques et th√©matiques",
                    "classic": "üé≠ √âl√©ments narratifs classiques",
                    "other": "Autres √©l√©ments narratifs"
                };
                
                optgroup.label = categoryLabels[category] || category;
                
                appData.plotTypes[category].forEach(typeObj => {
                    const option = document.createElement('option');
                    option.value = typeObj.name;
                    option.textContent = typeObj.name;
                    option.title = typeObj.description; // Tooltip pour l'explication
                    optgroup.appendChild(option);
                });
                
                select.appendChild(optgroup);
            });
            
            // Ajouter un √©v√©nement pour afficher l'explication quand on survole une option
            select.addEventListener('mouseover', function(e) {
                if (e.target.tagName === 'OPTION' && e.target.title) {
                    // Cr√©er un tooltip personnalis√© si n√©cessaire
                    // Pour l'instant, on utilise l'attribut title natif
                }
            });
        }
        
        // Navigation par onglets
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                // D√©sactiver tous les onglets
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Activer l'onglet s√©lectionn√©
                button.classList.add('active');
                document.getElementById(button.dataset.tab).classList.add('active');
            });
        });
        
        // Gestion des formulaires
        document.getElementById('character-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const selectedRoles = Array.from(document.querySelectorAll('input[name="story-roles"]:checked'))
                .map(checkbox => checkbox.value);
            
            const character = {
                id: Date.now(),
                name: document.getElementById('character-name').value,
                role: document.getElementById('character-role').value,
                storyRoles: selectedRoles,
                appearance: document.getElementById('character-appearance').value,
                personality: document.getElementById('character-personality').value,
                backstory: document.getElementById('character-backstory').value,
                motivations: document.getElementById('character-motivations').value,
                flaws: document.getElementById('character-flaws').value
            };
            
            appData.characters.push(character);
            saveData();
            renderCharacters();
            this.reset();
            
            // R√©initialiser les cases √† cocher
            document.querySelectorAll('input[name="story-roles"]').forEach(checkbox => {
                checkbox.checked = false;
            });
        });
        
        document.getElementById('location-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const location = {
                id: Date.now(),
                name: document.getElementById('location-name').value,
                type: document.getElementById('location-type').value,
                description: document.getElementById('location-description').value,
                atmosphere: document.getElementById('location-atmosphere').value,
                history: document.getElementById('location-history').value,
                importance: document.getElementById('location-importance').value,
                characters: document.getElementById('location-characters').value
            };
            
            appData.locations.push(location);
            saveData();
            renderLocations();
            this.reset();
        });
        
        document.getElementById('plot-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const plotElement = {
                id: Date.now(),
                type: document.getElementById('plot-element-type').value,
                title: document.getElementById('plot-title').value,
                description: document.getElementById('plot-description').value,
                characters: document.getElementById('plot-characters').value,
                locations: document.getElementById('plot-locations').value,
                importance: document.getElementById('plot-importance').value
            };
            
            appData.plotElements.push(plotElement);
            saveData();
            renderPlotElements();
            this.reset();
        });
        
        document.getElementById('story-role-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const storyRole = {
                id: Date.now(),
                name: document.getElementById('role-name').value,
                description: document.getElementById('role-description').value,
                examples: document.getElementById('role-examples').value
            };
            
            appData.storyRoles.push(storyRole);
            saveData();
            renderStoryRoles();
            updateStoryRolesCheckboxes();
            this.reset();
        });
        
        // Formulaire pour ajouter un nouveau type de lieu
        document.getElementById('custom-location-type-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newType = document.getElementById('new-location-type').value;
            const category = document.getElementById('new-location-category').value;
            
            if (newType && !appData.locationTypes[category].includes(newType)) {
                appData.locationTypes[category].push(newType);
                saveData();
                updateLocationTypesDropdown();
                this.reset();
                alert(`Type de lieu "${newType}" ajout√© avec succ√®s !`);
            } else {
                alert("Ce type de lieu existe d√©j√† ou le champ est vide.");
            }
        });
        
        // Formulaire pour ajouter un nouveau type d'√©l√©ment narratif
        document.getElementById('custom-plot-type-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newType = document.getElementById('new-plot-type').value;
            const category = document.getElementById('new-plot-category').value;
            
            if (newType) {
                // V√©rifier si le type existe d√©j√† dans n'importe quelle cat√©gorie
                let typeExists = false;
                Object.keys(appData.plotTypes).forEach(cat => {
                    if (appData.plotTypes[cat].some(t => t.name === newType)) {
                        typeExists = true;
                    }
                });
                
                if (!typeExists) {
                    appData.plotTypes[category].push({
                        name: newType,
                        description: "√âl√©ment narratif personnalis√© - ajoutez votre propre description"
                    });
                    saveData();
                    updatePlotTypesDropdown();
                    this.reset();
                    alert(`Type d'√©l√©ment narratif "${newType}" ajout√© avec succ√®s !`);
                } else {
                    alert("Ce type d'√©l√©ment narratif existe d√©j√†.");
                }
            } else {
                alert("Le champ ne peut pas √™tre vide.");
            }
        });
        
        // Afficher les personnages
        function renderCharacters() {
            const container = document.getElementById('characters-list');
            container.innerHTML = '';
            
            appData.characters.forEach(character => {
                const card = document.createElement('div');
                card.className = 'card';
                
                const roleLabels = {
                    'protagonist': 'Protagoniste',
                    'antagonist': 'Antagoniste',
                    'deuteragonist': 'Deut√©ragoniste',
                    'tritagonist': 'Tritagoniste',
                    'confidant': 'Confident',
                    'love-interest': 'Int√©r√™t amoureux',
                    'foil': 'Contrepoint',
                    'mentor': 'Mentor',
                    'supporting': 'Secondaire',
                    'minor': 'Figurant'
                };
                
                let rolesHTML = '';
                if (character.storyRoles && character.storyRoles.length > 0) {
                    rolesHTML = '<div style="margin-top: 10px;">';
                    character.storyRoles.forEach(roleId => {
                        const role = appData.storyRoles.find(r => r.id == roleId);
                        if (role) {
                            rolesHTML += `<span class="role-tag">${role.name}</span>`;
                        }
                    });
                    rolesHTML += '</div>';
                }
                
                card.innerHTML = `
                    <div class="character-avatar">${character.name.charAt(0)}</div>
                    <h3>${character.name}</h3>
                    <p><strong>R√¥le:</strong> ${roleLabels[character.role]}</p>
                    <p>${character.personality.substring(0, 100)}...</p>
                    ${rolesHTML}
                    <div class="card-actions">
                        <button class="btn btn-secondary" onclick="viewCharacter(${character.id})">Voir</button>
                        <button class="btn btn-secondary" onclick="deleteCharacter(${character.id})">Supprimer</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Afficher les lieux
        function renderLocations() {
            const container = document.getElementById('locations-list');
            container.innerHTML = '';
            
            appData.locations.forEach(location => {
                const card = document.createElement('div');
                card.className = 'card';
                
                card.innerHTML = `
                    <h3>${location.name}</h3>
                    <p><strong>Type:</strong> ${location.type}</p>
                    <p>${location.description.substring(0, 100)}...</p>
                    <div class="card-actions">
                        <button class="btn btn-secondary" onclick="viewLocation(${location.id})">Voir</button>
                        <button class="btn btn-secondary" onclick="deleteLocation(${location.id})">Supprimer</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Afficher les √©l√©ments d'intrigue
        function renderPlotElements() {
            const container = document.getElementById('plot-list');
            container.innerHTML = '';
            
            appData.plotElements.forEach(element => {
                const card = document.createElement('div');
                card.className = 'card';
                
                const importanceLabels = {
                    'low': 'Faible',
                    'medium': 'Moyenne',
                    'high': '√âlev√©e',
                    'critical': 'Critique'
                };
                
                card.innerHTML = `
                    <h3>${element.title}</h3>
                    <p><strong>Type:</strong> ${element.type}</p>
                    <p><strong>Importance:</strong> ${importanceLabels[element.importance]}</p>
                    <p>${element.description.substring(0, 100)}...</p>
                    <div class="card-actions">
                        <button class="btn btn-secondary" onclick="viewPlotElement(${element.id})">Voir</button>
                        <button class="btn btn-secondary" onclick="deletePlotElement(${element.id})">Supprimer</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Afficher les r√¥les narratifs
        function renderStoryRoles() {
            const container = document.getElementById('story-roles-list');
            container.innerHTML = '';
            
            appData.storyRoles.forEach(role => {
                const card = document.createElement('div');
                card.className = 'card';
                
                card.innerHTML = `
                    <h3>${role.name}</h3>
                    <p>${role.description}</p>
                    <p><strong>Exemples:</strong> ${role.examples}</p>
                    <div class="card-actions">
                        <button class="btn btn-secondary" onclick="viewStoryRole(${role.id})">Voir</button>
                        <button class="btn btn-secondary" onclick="deleteStoryRole(${role.id})">Supprimer</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Mettre √† jour les cases √† cocher des r√¥les narratifs
        function updateStoryRolesCheckboxes() {
            const container = document.getElementById('story-roles-checkboxes');
            container.innerHTML = '';
            
            appData.storyRoles.forEach(role => {
                const checkbox = document.createElement('div');
                checkbox.innerHTML = `
                    <label style="display: inline-flex; align-items: center; margin-right: 15px;">
                        <input type="checkbox" name="story-roles" value="${role.id}" style="width: auto; margin-right: 5px;">
                        ${role.name}
                    </label>
                `;
                container.appendChild(checkbox);
            });
        }
        
        // Fonctions pour visualiser les √©l√©ments (simplifi√©es pour cet exemple)
        function viewCharacter(id) {
            const character = appData.characters.find(c => c.id === id);
            let rolesText = '';
            if (character.storyRoles && character.storyRoles.length > 0) {
                rolesText = '\nR√¥les narratifs: ' + character.storyRoles.map(roleId => {
                    const role = appData.storyRoles.find(r => r.id == roleId);
                    return role ? role.name : '';
                }).join(', ');
            }
            
            alert(`Nom: ${character.name}\nR√¥le: ${character.role}${rolesText}\nApparence: ${character.appearance}\nPersonnalit√©: ${character.personality}\nHistoire: ${character.backstory}\nMotivations: ${character.motivations}\nFaiblesses: ${character.flaws}`);
        }
        
        function viewLocation(id) {
            const location = appData.locations.find(l => l.id === id);
            alert(`Nom: ${location.name}\nType: ${location.type}\nDescription: ${location.description}\nAtmosph√®re: ${location.atmosphere}\nHistoire: ${location.history}\nImportance: ${location.importance}\nPersonnages: ${location.characters}`);
        }
        
        function viewPlotElement(id) {
            const element = appData.plotElements.find(p => p.id === id);
            
            // Trouver la description de cet √©l√©ment narratif
            let elementDescription = "Aucune description disponible";
            Object.keys(appData.plotTypes).forEach(category => {
                const found = appData.plotTypes[category].find(t => t.name === element.type);
                if (found) {
                    elementDescription = found.description;
                }
            });
            
            alert(`Titre: ${element.title}\nType: ${element.type}\nDescription: ${element.description}\nPersonnages: ${element.characters}\nLieux: ${element.locations}\nImportance: ${element.importance}\n\nExplication du type:\n${elementDescription}`);
        }
        
        function viewStoryRole(id) {
            const role = appData.storyRoles.find(r => r.id === id);
            alert(`Nom: ${role.name}\nDescription: ${role.description}\nExemples: ${role.examples}`);
        }
        
        // Fonctions de suppression
        function deleteCharacter(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer ce personnage?')) {
                appData.characters = appData.characters.filter(c => c.id !== id);
                saveData();
                renderCharacters();
            }
        }
        
        function deleteLocation(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer ce lieu?')) {
                appData.locations = appData.locations.filter(l => l.id !== id);
                saveData();
                renderLocations();
            }
        }
        
        function deletePlotElement(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet √©l√©ment d\'intrigue?')) {
                appData.plotElements = appData.plotElements.filter(p => p.id !== id);
                saveData();
                renderPlotElements();
            }
        }
        
        function deleteStoryRole(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer ce r√¥le narratif?')) {
                appData.storyRoles = appData.storyRoles.filter(r => r.id !== id);
                saveData();
                renderStoryRoles();
                updateStoryRolesCheckboxes();
            }
        }
        
        // G√©n√©rateurs d'inspiration
        const conflicts = [
            "Un secret familial refait surface et menace de d√©truire tout ce que le personnage a construit.",
            "Deux alli√©s d√©couvrent qu'ils poursuivent des objectifs diam√©tralement oppos√©s.",
            "Le personnage doit choisir entre son devoir et ses sentiments personnels.",
            "Une force naturelle impr√©vue met en p√©ril la communaut√© tout enti√®re.",
            "Le personnage d√©couvre que son mentor lui a menti sur quelque chose de fondamental.",
            "Une rivalit√© professionnelle d√©g√©n√®re en guerre ouverte avec des cons√©quences d√©sastreuses.",
            "Le personnage est accus√© d'un crime qu'il n'a pas commis et doit prouver son innocence.",
            "Une mal√©diction ancienne s'abat sur le royaume et seul un sacrifice peut l'arr√™ter.",
            "La technologie sur laquelle repose la soci√©t√© commence √† montrer des signes de d√©faillance catastrophique.",
            "Un √™tre cher est pris en otage et le personnage doit trahir ses principes pour le sauver."
        ];
        
        const relationships = [
            "Deux ennemis jur√©s doivent s'allier pour survivre √† une menace commune.",
            "Une relation d'amiti√© se transforme lentement en rivalit√© toxique.",
            "Un mentor et son √©l√®ve d√©couvrent qu'ils partagent un lien de parent√© inattendu.",
            "Deux personnes de milieux sociaux tr√®s diff√©rents tombent amoureuses malgr√© les obstacles.",
            "Une relation fraternelle est mise √† l'√©preuve par un h√©ritage contest√©.",
            "Un ancien amour refait surface au moment le plus inopportun, cr√©ant un triangle amoureux.",
            "Le sauveur et la personne sauv√©e d√©veloppent une relation de d√©pendance malsaine.",
            "Deux espions de factions ennemies tombent amoureux lors d'une mission.",
            "Une amiti√© d'enfance est test√©e lorsque l'un acc√®de au pouvoir et l'autre reste dans l'ombre.",
            "Le bourreau et sa victime d√©veloppent une relation complexe bas√©e sur la compr√©hension mutuelle."
        ];
        
        const scenarios = [
            "Un √©tranger arrive dans une communaut√© isol√©e, apportant avec lui √† la fois l'espoir et le danger.",
            "La d√©couverte d'un artefact ancien conf√®re des pouvoirs extraordinaires mais √† un prix terrible.",
            "Une proph√©tie oubli√©e semble s'accomplir, mais pas de la mani√®re que quiconque avait pr√©vu.",
            "Un personnage ordinaire d√©couvre qu'il est l'h√©ritier d'un royaume dont il ignorait l'existence.",
            "Une exp√©rience scientifique tourne mal, lib√©rant quelque chose qui ne devrait pas exister.",
            "La derni√®re biblioth√®que d'un savoir ancien est menac√©e de destruction par un pouvoir tyrannique.",
            "Un groupe de marginaux doit unir ses forces pour sauver un monde qui les a rejet√©s.",
            "Le temps commence √† s'√©couler √† l'envers, et seul un groupe de personnes en est conscient.",
            "Dans une soci√©t√© o√π les √©motions sont contr√¥l√©es, quelqu'un commence √† ressentir librement.",
            "Les morts se r√©veillent, mais pas comme des zombies - ils reviennent exactement comme ils √©taient avant de mourir."
        ];
        
        const worlds = [
            "Un monde o√π la magie est une ressource rare et pr√©cieuse, contr√¥l√©e par une √©lite corrompue.",
            "Une soci√©t√© steampunk o√π la technologie √† vapeur a atteint des niveaux incroyables de sophistication.",
            "Une plan√®te avec plusieurs soleils, o√π la notion de 'nuit' n'existe pas et la soci√©t√© s'est adapt√©e en cons√©quence.",
            "Un univers o√π les r√™ves sont tangibles et peuvent √™tre collect√©s, √©chang√©s ou m√™me vol√©s.",
            "Une civilisation sous-marine d√©velopp√©e, avec des villes construites dans les abysses oc√©aniques.",
            "Un monde post-apocalyptique o√π la nature a repris ses droits sur les ruines de l'ancienne civilisation.",
            "Une dimension parall√®le o√π les lois de la physique sont diff√©rentes et la magie est commune.",
            "Une soci√©t√© futuriste o√π les humains peuvent t√©l√©charger leurs consciences dans des corps artificiels.",
            "Un royaume flottant constitu√© d'√Æles volantes, chacune avec sa propre culture et √©cosyst√®me.",
            "Une terre o√π les fronti√®res entre les contes de f√©es et la r√©alit√© sont de plus en plus floues."
        ];
        
        const dilemmas = [
            "Sacrifier une personne innocente pour en sauver mille.",
            "D√©noncer un √™tre cher pour un crime mineur ou le prot√©ger et risquer des cons√©quences pires.",
            "Utiliser une arme immorale pour gagner une guerre juste.",
            "Garder un secret qui prot√©gerait beaucoup de gens mais mentirait √† quelqu'un qui vous fait confiance.",
            "Choisir entre sauver votre famille ou des inconnus qui pourraient changer le destin du monde.",
            "Trahir vos principes pour obtenir un pouvoir qui vous permettrait de faire plus de bien √† long terme.",
            "D√©truire une ≈ìuvre d'art inestimable pour sauver des vies.",
            "Laisser un m√©chant s'√©chapper pour sauver un otage, sachant qu'il fera plus de mal plus tard.",
            "Utiliser la connaissance d'un futur possible pour changer le pr√©sent, au risque de cr√©er un paradoxe.",
            "R√©v√©ler une v√©rit√© qui lib√©rera une soci√©t√© mais d√©truira la vie de personnes innocentes."
        ];
        
        const endings = [
            "Le h√©ros meurt en accomplissant sa mission, devenant une l√©gende pour les g√©n√©rations futures.",
            "L'antagoniste se rach√®te au dernier moment, sacrifiant sa vie pour le bien commun.",
            "Il s'av√®re que toute l'aventure n'√©tait qu'un r√™ve ou une simulation.",
            "Le h√©ros d√©couvre qu'il √©tait le m√©chant de l'histoire tout along.",
            "Le conflit principal se r√©sout par la communication et la compr√©hension mutuelle plut√¥t que par la violence.",
            "Le monde est sauv√©, mais au prix de la perte de la magie/technologie qui le rendait sp√©cial.",
            "Le h√©ros renonce √† son pouvoir ou √† son statut pour vivre une vie simple et heureuse.",
            "L'histoire se termine sur un cliffhanger, pr√©parant une suite.",
            "Le h√©ros et l'antagoniste r√©alisent qu'ils ont √©t√© manipul√©s par une tierce partie tout au long du conflit.",
            "La fin est ouverte, laissant au lecteur le soin d'imaginer ce qui se passe ensuite."
        ];
        
        document.getElementById('generate-conflict').addEventListener('click', function() {
            const randomConflict = conflicts[Math.floor(Math.random() * conflicts.length)];
            document.getElementById('conflict-generator').innerHTML = `<p>${randomConflict}</p>`;
        });
        
        document.getElementById('generate-relationship').addEventListener('click', function() {
            const randomRelationship = relationships[Math.floor(Math.random() * relationships.length)];
            document.getElementById('relationship-generator').innerHTML = `<p>${randomRelationship}</p>`;
        });
        
        document.getElementById('generate-scenario').addEventListener('click', function() {
            const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
            document.getElementById('scenario-generator').innerHTML = `<p>${randomScenario}</p>`;
        });
        
        document.getElementById('generate-world').addEventListener('click', function() {
            const randomWorld = worlds[Math.floor(Math.random() * worlds.length)];
            document.getElementById('world-generator').innerHTML = `<p>${randomWorld}</p>`;
        });
        
        document.getElementById('generate-dilemma').addEventListener('click', function() {
            const randomDilemma = dilemmas[Math.floor(Math.random() * dilemmas.length)];
            document.getElementById('dilemma-generator').innerHTML = `<p>${randomDilemma}</p>`;
        });
        
        document.getElementById('generate-ending').addEventListener('click', function() {
            const randomEnding = endings[Math.floor(Math.random() * endings.length)];
            document.getElementById('ending-generator').innerHTML = `<p>${randomEnding}</p>`;
        });
        
        // Gestion de l'exportation
        document.getElementById('export-btn').addEventListener('click', function() {
            document.getElementById('export-modal').style.display = 'flex';
        });
        
        document.getElementById('export-json').addEventListener('click', function() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            downloadBlob(dataBlob, 'romancraft-data.json');
        });
        
        document.getElementById('export-text').addEventListener('click', function() {
            let textContent = "ROMANCRAFT - EXPORTATION DE DONN√âES\n\n";
            textContent += "PERSONNAGES\n";
            appData.characters.forEach(char => {
                textContent += `- ${char.name} (${char.role})\n`;
            });
            
            textContent += "\nLIEUX\n";
            appData.locations.forEach(loc => {
                textContent += `- ${loc.name} (${loc.type})\n`;
            });
            
            textContent += "\n√âL√âMENTS D'INTRIGUE\n";
            appData.plotElements.forEach(plot => {
                textContent += `- ${plot.title} (${plot.type})\n`;
            });
            
            textContent += "\nR√îLES NARRATIFS\n";
            appData.storyRoles.forEach(role => {
                textContent += `- ${role.name}\n`;
            });
            
            const dataBlob = new Blob([textContent], {type: 'text/plain'});
            downloadBlob(dataBlob, 'romancraft-data.txt');
        });
        
        document.getElementById('export-word').addEventListener('click', function() {
            // Simulation d'export Word - dans une vraie application, on utiliserait une biblioth√®que
            alert("Fonctionnalit√© d'export Word - Dans une version compl√®te, cela g√©n√©rerait un vrai fichier .docx");
        });
        
        // Gestion de l'importation
        document.getElementById('import-btn').addEventListener('click', function() {
            document.getElementById('import-modal').style.display = 'flex';
        });
        
        document.getElementById('confirm-import').addEventListener('click', function() {
            const fileInput = document.getElementById('import-file');
            const merge = document.getElementById('import-merge').checked;
            
            if (fileInput.files.length === 0) {
                alert("Veuillez s√©lectionner un fichier √† importer.");
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (merge) {
                        // Fusionner avec les donn√©es existantes
                        if (importedData.characters) {
                            appData.characters = [...appData.characters, ...importedData.characters];
                        }
                        if (importedData.locations) {
                            appData.locations = [...appData.locations, ...importedData.locations];
                        }
                        if (importedData.plotElements) {
                            appData.plotElements = [...appData.plotElements, ...importedData.plotElements];
                        }
                        if (importedData.storyRoles) {
                            appData.storyRoles = [...appData.storyRoles, ...importedData.storyRoles];
                        }
                        if (importedData.locationTypes) {
                            // Fusionner les types de lieux
                            Object.keys(importedData.locationTypes).forEach(category => {
                                if (appData.locationTypes[category]) {
                                    importedData.locationTypes[category].forEach(type => {
                                        if (!appData.locationTypes[category].includes(type)) {
                                            appData.locationTypes[category].push(type);
                                        }
                                    });
                                } else {
                                    appData.locationTypes[category] = importedData.locationTypes[category];
                                }
                            });
                        }
                        if (importedData.plotTypes) {
                            // Fusionner les types d'√©l√©ments narratifs
                            Object.keys(importedData.plotTypes).forEach(category => {
                                if (appData.plotTypes[category]) {
                                    importedData.plotTypes[category].forEach(newType => {
                                        const exists = appData.plotTypes[category].some(existingType => 
                                            existingType.name === newType.name
                                        );
                                        if (!exists) {
                                            appData.plotTypes[category].push(newType);
                                        }
                                    });
                                } else {
                                    appData.plotTypes[category] = importedData.plotTypes[category];
                                }
                            });
                        }
                    } else {
                        // Remplacer les donn√©es existantes
                        appData = importedData;
                    }
                    
                    saveData();
                    renderCharacters();
                    renderLocations();
                    renderPlotElements();
                    renderStoryRoles();
                    updateStoryRolesCheckboxes();
                    updateLocationTypesDropdown();
                    updatePlotTypesDropdown();
                    
                    document.getElementById('import-modal').style.display = 'none';
                    alert("Donn√©es import√©es avec succ√®s!");
                } catch (error) {
                    alert("Erreur lors de l'importation: le fichier n'est pas au format valide.");
                }
            };
            
            reader.readAsText(file);
        });
        
        // Fonction utilitaire pour t√©l√©charger un blob
        function downloadBlob(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Fermer les modales
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });
        
        // Fermer les modales en cliquant √† l'ext√©rieur
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
        
        // Initialiser l'application
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateLocationTypesDropdown();
            updatePlotTypesDropdown();
            
            // Activer les g√©n√©rateurs d'inspiration
            document.getElementById('generate-conflict').click();
            document.getElementById('generate-relationship').click();
            document.getElementById('generate-scenario').click();
            document.getElementById('generate-world').click();
            document.getElementById('generate-dilemma').click();
            document.getElementById('generate-ending').click();
        });
        
        // Service Worker pour PWA (simplifi√©)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful');
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>